{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/cerigoff/instagram_redesign_release_v1/frontend/components/main/Feed.js\";\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { FontAwesome5, Feather, Entypo } from '@expo/vector-icons';\nimport firebase from 'firebase';\n\nrequire('firebase/firestore');\n\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { reload } from \"../../redux/actions/index\";\nimport { text, utils, container, navbar } from \"../styles\";\nimport { timeDifference } from \"../utils\";\n\nfunction Feed(props) {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      posts = _useState2[0],\n      setPosts = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      refreshing = _useState4[0],\n      setRefreshing = _useState4[1];\n\n  useEffect(function () {\n    if (props.usersFollowingLoaded == props.following.length && props.following.length !== 0) {\n      props.feed.sort(function (x, y) {\n        return y.creation.toDate() - x.creation.toDate();\n      });\n      setPosts(props.feed);\n      setRefreshing(false);\n    }\n  }, [props.usersFollowingLoaded, props.feed]);\n\n  var onLikePress = function onLikePress(userId, postId, item) {\n    item.likesCount += 1;\n    firebase.firestore().collection(\"posts\").doc(userId).collection(\"userPosts\").doc(postId).collection(\"likes\").doc(firebase.auth().currentUser.uid).set({}).then();\n  };\n\n  var onDislikePress = function onDislikePress(userId, postId, item) {\n    item.likesCount -= 1;\n    firebase.firestore().collection(\"posts\").doc(userId).collection(\"userPosts\").doc(postId).collection(\"likes\").doc(firebase.auth().currentUser.uid).delete();\n  };\n\n  return React.createElement(View, {\n    style: [container.container, utils.backgroundWhite],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: [navbar.custom, utils.alignItemsCenter, container.horizontal],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: [navbar.title, container.fillHorizontal],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 17\n    }\n  }, \"Instagram\"), React.createElement(Feather, {\n    name: \"send\",\n    size: 30,\n    color: \"black\",\n    onPress: function onPress() {\n      return props.navigation.navigate(\"ChatList\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 17\n    }\n  })), React.createElement(FlatList, {\n    refreshControl: React.createElement(RefreshControl, {\n      refreshing: refreshing,\n      onRefresh: function onRefresh() {\n        setRefreshing(true);\n        props.reload();\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 21\n      }\n    }),\n    numColumns: 1,\n    horizontal: false,\n    data: posts,\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return React.createElement(View, {\n        style: container.containerImage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 21\n        }\n      }, React.createElement(TouchableOpacity, {\n        style: [container.horizontal, utils.padding15],\n        onPress: function onPress() {\n          return props.navigation.navigate(\"Profile\", {\n            uid: item.user.uid\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 25\n        }\n      }, item.user.image == 'default' ? React.createElement(FontAwesome5, {\n        style: [utils.profileImageSmall, utils.marginBottomSmall],\n        name: \"user-circle\",\n        size: 35,\n        color: \"black\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 37\n        }\n      }) : React.createElement(Image, {\n        style: [utils.profileImageSmall, utils.marginBottomSmall],\n        source: {\n          uri: item.user.image\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 37\n        }\n      }), React.createElement(View, {\n        style: utils.justifyCenter,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 29\n        }\n      }, React.createElement(Text, {\n        style: [text.bold, text.medium],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 33\n        }\n      }, item.user.name))), React.createElement(Image, {\n        style: container.image,\n        source: {\n          uri: item.downloadURL\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 25\n        }\n      }), React.createElement(View, {\n        style: [container.container, utils.padding10, container.horizontal],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 25\n        }\n      }, item.currentUserLike ? React.createElement(Entypo, {\n        name: \"heart\",\n        size: 30,\n        color: \"red\",\n        onPress: function onPress() {\n          return onDislikePress(item.user.uid, item.id, item);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 37\n        }\n      }) : React.createElement(Feather, {\n        name: \"heart\",\n        size: 30,\n        color: \"black\",\n        onPress: function onPress() {\n          return onLikePress(item.user.uid, item.id, item);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 37\n        }\n      }), React.createElement(Feather, {\n        style: utils.margin15Left,\n        name: \"message-square\",\n        size: 30,\n        color: \"black\",\n        onPress: function onPress() {\n          return props.navigation.navigate('Comment', {\n            postId: item.id,\n            uid: item.user.uid\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 29\n        }\n      })), React.createElement(View, {\n        style: [container.container, utils.padding10Sides],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 25\n        }\n      }, React.createElement(Text, {\n        style: [text.bold, text.medium],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 29\n        }\n      }, item.likesCount, \" likes\"), React.createElement(Text, {\n        style: [utils.margin15Right, utils.margin5Bottom],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 29\n        }\n      }, React.createElement(Text, {\n        style: [text.bold],\n        onPress: function onPress() {\n          return props.navigation.navigate(\"Profile\", {\n            uid: item.user.id\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 33\n        }\n      }, item.user.name), \" \", \"  \", item.caption), React.createElement(Text, {\n        style: [text.grey, utils.margin5Bottom],\n        onPress: function onPress() {\n          return props.navigation.navigate('Comment', {\n            postId: item.id,\n            uid: item.user.uid\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 29\n        }\n      }, \"View all \", item.commentsCount, \" Comments\"), React.createElement(Text, {\n        style: [text.grey, text.small, utils.margin5Bottom],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 29\n        }\n      }, timeDifference(new Date(), item.creation.toDate()))));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }\n  }));\n}\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    currentUser: store.userState.currentUser,\n    following: store.userState.following,\n    feed: store.usersState.feed,\n    usersFollowingLoaded: store.usersState.usersFollowingLoaded\n  };\n};\n\nvar mapDispatchProps = function mapDispatchProps(dispatch) {\n  return bindActionCreators({\n    reload: reload\n  }, dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchProps)(Feed);","map":{"version":3,"sources":["/Users/cerigoff/instagram_redesign_release_v1/frontend/components/main/Feed.js"],"names":["React","useState","useEffect","FontAwesome5","Feather","Entypo","firebase","require","connect","bindActionCreators","reload","text","utils","container","navbar","timeDifference","Feed","props","posts","setPosts","refreshing","setRefreshing","usersFollowingLoaded","following","length","feed","sort","x","y","creation","toDate","onLikePress","userId","postId","item","likesCount","firestore","collection","doc","auth","currentUser","uid","set","then","onDislikePress","delete","backgroundWhite","custom","alignItemsCenter","horizontal","title","fillHorizontal","navigation","navigate","containerImage","padding15","user","image","profileImageSmall","marginBottomSmall","uri","justifyCenter","bold","medium","name","downloadURL","padding10","currentUserLike","id","margin15Left","padding10Sides","margin15Right","margin5Bottom","caption","grey","commentsCount","small","Date","mapStateToProps","store","userState","usersState","mapDispatchProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { View, Text, Image, FlatList, RefreshControl, ScrollView, TouchableOpacity } from 'react-native'\nimport { FontAwesome5, Feather, Entypo } from '@expo/vector-icons';\nimport firebase from 'firebase'\nrequire('firebase/firestore')\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport { reload } from '../../redux/actions/index'\nimport { text, utils, container, navbar } from '../styles'\nimport { timeDifference } from '../utils'\n\nfunction Feed(props) {\n    const [posts, setPosts] = useState([]);\n    const [refreshing, setRefreshing] = useState(false)\n\n    useEffect(() => {\n        if (props.usersFollowingLoaded == props.following.length && props.following.length !== 0) {\n            props.feed.sort(function (x, y) {\n                return y.creation.toDate() - x.creation.toDate();\n            })\n\n            setPosts(props.feed);\n            setRefreshing(false)\n        }\n    }, [props.usersFollowingLoaded, props.feed])\n\n    const onLikePress = (userId, postId, item) => {\n        item.likesCount += 1;\n        firebase.firestore()\n            .collection(\"posts\")\n            .doc(userId)\n            .collection(\"userPosts\")\n            .doc(postId)\n            .collection(\"likes\")\n            .doc(firebase.auth().currentUser.uid)\n            .set({})\n            .then()\n\n    }\n    const onDislikePress = (userId, postId, item) => {\n        item.likesCount -= 1;\n\n        firebase.firestore()\n            .collection(\"posts\")\n            .doc(userId)\n            .collection(\"userPosts\")\n            .doc(postId)\n            .collection(\"likes\")\n            .doc(firebase.auth().currentUser.uid)\n            .delete()\n    }\n    return (\n        <View style={[container.container, utils.backgroundWhite]}>\n            <View style={[navbar.custom, utils.alignItemsCenter, container.horizontal]}>\n                <Text style={[navbar.title, container.fillHorizontal]}>Instagram</Text>\n                <Feather name=\"send\" size={30} color=\"black\"\n                    onPress={() => props.navigation.navigate(\"ChatList\")}\n                />\n            </View>\n\n\n            <FlatList\n                refreshControl={\n                    <RefreshControl\n                        refreshing={refreshing}\n                        onRefresh={() => {\n                            setRefreshing(true);\n                            props.reload()\n                        }}\n                    />\n                }\n                numColumns={1}\n                horizontal={false}\n                data={posts}\n                renderItem={({ item }) => (\n                    <View\n                        style={container.containerImage}>\n                        <TouchableOpacity\n                            style={[container.horizontal, utils.padding15]}\n                            onPress={() => props.navigation.navigate(\"Profile\", { uid: item.user.uid })}>\n\n                            {item.user.image == 'default' ?\n                                (\n                                    <FontAwesome5\n                                        style={[utils.profileImageSmall, utils.marginBottomSmall]}\n                                        name=\"user-circle\" size={35} color=\"black\" />\n\n                                )\n                                :\n                                (\n                                    <Image\n                                        style={[utils.profileImageSmall, utils.marginBottomSmall]}\n                                        source={{\n                                            uri: item.user.image\n                                        }}\n                                    />\n                                )\n                            }\n                            <View style={utils.justifyCenter}>\n                                <Text style={[text.bold, text.medium]} >{item.user.name}</Text>\n                            </View>\n                        </TouchableOpacity>\n                        <Image\n                            style={container.image}\n                            source={{ uri: item.downloadURL }}\n                        />\n\n                        <View style={[container.container, utils.padding10, container.horizontal]}>\n                            {item.currentUserLike ?\n                                (\n                                    <Entypo name=\"heart\" size={30} color=\"red\" onPress={() => onDislikePress(item.user.uid, item.id, item)} />\n                                )\n                                :\n                                (\n                                    <Feather name=\"heart\" size={30} color=\"black\" onPress={() => onLikePress(item.user.uid, item.id, item)} />\n\n                                )\n                            }\n                            <Feather style={utils.margin15Left} name=\"message-square\" size={30} color=\"black\" onPress={() => props.navigation.navigate('Comment', { postId: item.id, uid: item.user.uid })} />\n                        </View>\n                        <View style={[container.container, utils.padding10Sides]}>\n                            <Text style={[text.bold, text.medium]}>\n                                {item.likesCount} likes\n                                </Text>\n                            <Text style={[utils.margin15Right, utils.margin5Bottom]}>\n                                <Text style={[text.bold]}\n                                    onPress={() => props.navigation.navigate(\"Profile\", { uid: item.user.id })}>\n                                    {item.user.name}\n                                </Text>\n                                {\" \"}  {item.caption}\n                            </Text>\n                            <Text\n                                style={[text.grey, utils.margin5Bottom]} onPress={() => props.navigation.navigate('Comment', { postId: item.id, uid: item.user.uid })}>\n                                View all {item.commentsCount} Comments\n                                </Text>\n                            <Text\n                                style={[text.grey, text.small, utils.margin5Bottom]}>\n                                {timeDifference(new Date(), item.creation.toDate())}\n                            </Text>\n                        </View>\n                    </View>\n\n                )}\n\n            />\n\n\n        </View>\n\n    )\n}\n\nconst mapStateToProps = (store) => ({\n    currentUser: store.userState.currentUser,\n    following: store.userState.following,\n    feed: store.usersState.feed,\n    usersFollowingLoaded: store.usersState.usersFollowingLoaded,\n\n\n})\n\nconst mapDispatchProps = (dispatch) => bindActionCreators({ reload }, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchProps)(Feed);\n"]},"metadata":{},"sourceType":"module"}